mol new 0ns.pdb waitfor all
mol addfile 121pro.xtc waitfor all
set num_frames [molinfo top get numframes]
set sel_all [atomselect top all]
mol new 0ns.pdb waitfor all
set sel_ref0 [atomselect 1 "protein and name CA" frame 0]
set sel_ref [atomselect 0 "protein and name CA"]
set sel_rmsd0 [atomselect 1 "protein and name CA" frame 0]
set sel_rmsd [atomselect 0 "protein and name CA"]
set outfile [open backboneAlign-CA "w"]
puts $outfile "# reference: protein and name CA; calculated region: protein and name CA"
for {set i 0} {$i<$num_frames} {incr i} {
    $sel_all frame $i
    $sel_ref frame $i
    $sel_rmsd frame $i
    $sel_all move [measure fit $sel_ref $sel_ref0]
    set rmsd [measure rmsd $sel_rmsd $sel_rmsd0 weight mass]
    puts $outfile "$i \t $rmsd"
}
close $outfile
quit
